[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "CPS ASEC 2023 Analysis",
    "section": "",
    "text": "1 Introduction\nHealth is undoubtedly a key dimension of our well-being. When we feel healthy, we tend to be more productive during work hours and enjoy our free time more. On the other hand, being sick is usually synonymous with feeling upset and without enough energy to pursue our goals. The words of the Roman poet Virgil come to mind: “The greatest wealth is health”. Then, it is meaningful to know the current health status of the U.S. population.\nFurthermore, it is plausible to believe that health status is not an isolated variable, but it is related with other dimensions such as race, age and economic status. Therefore, it is essential to understand how health relates to other metrics. The following questions then arise: are richer people healthier than poorer ones?, in a similar way, are employed people healthier than unemployed ones?, the level of education is positively correlated with the health status, i.e. are people with more education healthier? What is the relation with other dimensions such as race or sex? When disabled people are asked about their health status, what do they answer? Is the distribution of health status uniform across states or does it change? How is the health of native-born or naturalized US citizens related to that of non-US citizens? How does this latter relation change with age?\nWith these questions in mind, on this project we delve into the health status of people living in the United States. We analyze the distribution of health status and deepen on how it relates with other social, cultural, and economic metrics. Particularly, we are interested in understanding the relation between health and other dimensions such as age, sex, race, employment status, educational attainment, citizenship and earnings. We also study whether there are common patterns across regions in the United States.\nHaving a clear understanding of health across the country is not only important in terms of individual well-being, but also in terms of broader societal purposes. For instance, it makes sense to believe that a healthier society translates not only into more satisfied citizens, but also into a more productive workforce and, in turn, into a richer population. For both reasons, we believe that all policymakers should have a good understanding of the health status of their society.\nAs we have explained, on this project we will analyze the health status of United States society and its relations with different social, cultural, and economic dimensions. The project is structured as follows. In the ‘Data’ section we explain the data source, the selected features and the format of the dataset. In the ‘Results’ section we develop the analyses in detail, presenting the results through several graphics. In the ‘Interactive component in D3’ section we present one of our key findings through an animated format using D3. Finally, in the ‘Conclusion’ section we discuss the lessons learned and we outline recommendations regarding health as public policy."
  },
  {
    "objectID": "data.html#technical-description",
    "href": "data.html#technical-description",
    "title": "2  Data",
    "section": "2.1 Technical Description",
    "text": "2.1 Technical Description\nTo analyze health status of people living in the United States and its relations with other social, cultural and economic dimensions we use the Annual Social and Economic Supplement to the Current Population Survey (CPS-ASEC from now on). This data is collected annually -mainly during March- by the U.S. Census Bureau and includes information of more than 75,000 households. It is worth noting that the dataset contains information for every member of each of the participating households.\nThe data is available on the U.S. Census Bureau’s official website in both SAS and CSV format. As it is documentated in the official Data Dictionary, the variables may refer to three different record types: Household, Family or Person. For this project, we work with a subset of the ‘Person Type’ variables. Furthermore, as we also want to use georeferencing data, we incorporate the two ‘Household Type’ variables that point the state and county of every observation.\nThere is an available package in R called ‘cpsR’ see documentation here to import the data. Particularly, there is a function called ‘get_asec’ to load the data. However, to get the data, we first needed to request a key for the Census API through this official website. We’ll work with the most updated information so far: the 2023 CPS-ASEC dataset.\nThe 2023 CPS-ASEC dataset contains information of 146,133 individuals. Each row refers to a unique individual, identified with the variable ‘PERIDNUM’ (22-digit Unique Person identifier). Since the database is a sample, and logically does not cover the entire population, there is a variable ‘A_FNLWGT’ that contains the weight associated with each observation. It is important to take this variable into account so that the statistics and graphs are a fair representation of the overall US population.\nThere are in total 829 ‘Person Type’ variables in the dataset that cover a huge number of characteristics. For this project, since we are interested in health status and how it relates to specific social, cultural, and economic dimensions we have selected a subset of 10 ‘Person Type’ variables -additionally to the identifier and weight columns-.\nOur main variable is ‘HEA’ that refers to the health status of the person. This is a categorical variable that takes five possible values: 1 (that accounts for ‘Excellent’), 2 (‘Very good’), 3 (‘Good’), 4 (‘Fair’) or 5 (‘Poor’). We have also chosen two additional variables related to health: ‘DIS_HP’ and ‘NOW_COV’: the former indicates if the person has a health problem or a disability that prevents them from working and the latter indicates if the interviewed is currently covered by health insurance coverage. It is worth noting that ‘dis_hp’ is only available for persons aged at least 15. In addition to these 3 variables related to health, we will also work with 7 other dimensions to better understand how health relates with other metrics. These additional variables are ‘A_AGE’ (that refers to the age of the person), ‘A_SEX’ (sex), ‘PRDTRACE’ (race), ‘PEMLR’ (employment status), ‘A_HGA’ (educational attainment), ‘PRCITSHP’ (citizenship) and ‘PEARNVAL’ (earnings). Finally, as we have mentioned, we include two ‘Household Type’ variables: ‘GESTFIPS’ and ‘GTCO’ that refer respectively to the state and county in which each person is located. Regarding this point, one issue with the data is that it only covers a subset of about 1300 of the 3100 counties in the United States."
  },
  {
    "objectID": "data.html#research-plan",
    "href": "data.html#research-plan",
    "title": "2  Data",
    "section": "2.2 Research Plan",
    "text": "2.2 Research Plan\nThe main focus of the project is to understand the current health status of the US population. To assess it, we will analyze the variable ‘HEA’ from the Annual Social and Economic Supplement to the Current Population Survey that indicates the perception of the self state of health of each interviewed individual. It is worth noting that it is not an objective metric, but rather a subjective one. We will be considering this variable as a proxy of their actual state of health.\nIn addition, we are interested not only in health status, but also in its relation to other dimensions. For instance, as we pointed out in the Introduction, we wonder whether richer people are healthier -or not- than poorer ones. To understand this relationship, we will study how variables ‘HEA’ (health status) and ‘PEARNVAL’ (earnings) interact with each other. Although we will not analyze cause-effect relationships, we will study if these two dimensions are positively or negatively correlated - or maybe they are not related at all-. From an economic point of view, we should expect a positive relationship since, for example, higher earnings translate into a greater purchasing power to purchase better insurance coverage. However, there may be other factors that mediate this relation. Besides, as ‘HEA’ is a subjective measure, it could be the case that wealthier people compare their health status to the one of other wealthy people (rather than to the average population) and therefore we may not find a positive relation between economic status and health. To better understand this connection, we will also use the variables ‘DIS_HP’ and ‘NOW_COV’ that measure, respectively, if the person has a disability which prevents work, and if the person has currently health insurance coverage.\nIn a similar way, we are concerning about how employment status relates with health. It is reasonable to believe that employed people enjoy better general health. Indeed, we expect them to have more money and therefore spend more money on health treatments. Nevertheless, it could also be possible that employed people felt more stressed during the day of the interview, and their responses could underestimate their actual health status. We will deepen on this relationship analyzing the variables ‘HEA’ (health status) and ‘PEMLR’ (employment status).\nAnother research question is how the health of native-born or naturalized US citizens relates to that of non-US citizens that live in the US, and how this relation changes with age. To answer this question we will analyze the joint relationship between the variables ‘HEA’ (health status), ‘PRCITSHP’ (citizenship) and ‘A_AGE’ (age). This relationship can take different directions. For instance, it could be the case that nowadays there is no difference in health for young people between US citizens and non-US citizens. However, it is possible that some decades ago, there was a significant difference in health in terms of citizenship status -perhaps due to some health-related legislation- that persists for people who are older today. To answer this type of questions we need to analyze the three different dimensions at the same time -for example, using an adequate mosaic plot-.\nWe will also use georeferencing data of each person’s location to assess whether there are differences in health across states and counties in the United States. In particular, we will utilize the variables ‘GESTFIPS’ and ‘GTCO’ that indicate respectively the state and county of each observation. Finally, for all the previous analyses to be correct, we will weigh each observation with its respective weight indicated in the variable ‘A_FNLWGT’."
  },
  {
    "objectID": "data.html#initial-preprocessing",
    "href": "data.html#initial-preprocessing",
    "title": "2  Data",
    "section": "2.3 Initial preprocessing",
    "text": "2.3 Initial preprocessing\nWe first import and load the following packages:\n\n\nCode\n#install.packages(\"cpsR\")\n#install.packages(\"usethis\")\n#install.packages(\"DataExplorer\")\n#install.packages(\"remotes\")\n#remotes::install_github(\"jtr13/redav\") \n# install.packages(\"data.table\")\n\nlibrary(cpsR)\n\n\nWarning: package 'cpsR' was built under R version 4.3.2\n\n\nCode\nlibrary(tidyverse)\n\n\nWarning: package 'forcats' was built under R version 4.3.2\n\n\n── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──\n✔ dplyr     1.1.3     ✔ readr     2.1.4\n✔ forcats   1.0.0     ✔ stringr   1.5.0\n✔ ggplot2   3.4.3     ✔ tibble    3.2.1\n✔ lubridate 1.9.2     ✔ tidyr     1.3.0\n✔ purrr     1.0.2     \n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\nℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors\n\n\nCode\nlibrary(ggplot2)\nlibrary(DataExplorer)\n\n\nWarning: package 'DataExplorer' was built under R version 4.3.2\n\n\nCode\nlibrary(ggplot2)\nlibrary(data.table)\n\n\n\nAttaching package: 'data.table'\n\nThe following objects are masked from 'package:lubridate':\n\n    hour, isoweek, mday, minute, month, quarter, second, wday, week,\n    yday, year\n\nThe following objects are masked from 'package:dplyr':\n\n    between, first, last\n\nThe following object is masked from 'package:purrr':\n\n    transpose\n\n\nThen, we import the selected features from the 2023 CPS-ASEC dataset using the function ‘get_asec’ from the package ‘cpsR’:\n\n\nCode\ndf &lt;- get_asec(year = 2023, vars = c(\"PERIDNUM\", \"A_FNLWGT\", \"GESTFIPS\", \"GTCO\", \"HEA\", \"A_AGE\", \"A_SEX\", \"PRCITSHP\",\"PRDTRACE\", \"PEMLR\",\"A_HGA\",\"PEARNVAL\",\"DIS_HP\",\"NOW_COV\"), key=\"033d6fdb469d970444d91cda781be61fa0d46099\", tibble = FALSE)\n\n\nGetting CPS ASEC microdata for 2023\n\n\nWe rename each variable as follows:\n\n\nCode\ndf &lt;- df %&gt;% \n  rename(\n    ID = \"peridnum\",\n    Wt = \"a_fnlwgt\",\n    State = \"gestfips\",\n    Co = \"gtco\", # County\n    Health = \"hea\",\n    Age = \"a_age\",\n    Sex = \"a_sex\",\n    Citz = \"prcitshp\",\n    Race = \"prdtrace\",\n    Empt = \"pemlr\",\n    Edu = \"a_hga\",\n    Earn = \"pearnval\",\n    Pwd = \"dis_hp\",\n    Ins = \"now_cov\"\n    )\n\n\nSince there are certain features whose categories are too detailed for our purposes, we make the following preprocessing:\n\n\nCode\n### Sex ###\ndf$Sex &lt;- factor(df$Sex, levels = c(1, 2), labels = c(\"Male\", \"Female\"))\n\n### Citizenship ###\ndf$Citz &lt;- factor(df$Citz, levels = c(1, 2, 3, 4, 5), labels = c(\"Native\", \"Native\", \"Native\", \"Naturalized\", \"Not US Citizen\"))\n# We group:\n#     categories 1 (Native, born in the US), 2 (Native, born in PR or US outlying are) and 3 (Native, born abroad of US parent(s)) into \"Native\". \n#table(df$Citz)\n\n### Employment ###\ndf$Empt &lt;- factor(df$Empt, levels = c(0, 1, 2, 3, 4, 5, 6, 7), labels = c(\"NIU\",\"Employed\", \"Employed\", \"Unemployed\", \"Unemployed\", \"Retired\", \"Disabled\", \"Other\"))\n# We group: \n#     categories 1 (Employed - at work) and 2 (Employed - absent) into \"Employed\"\n#     categories 3 (Unemployed - on layoff) and 4 (Unemployed - looking) into \"Unemployed\". \n#table(df$Empt)\n\n### Education ###\n#table(df$Edu)\ndf$Edu &lt;- ifelse(df$Edu &gt;= 31 & df$Edu &lt;= 38, 30, df$Edu)\n# We group categories 31 to 38 into 30 (than we'll label it as \"High school Incomplete\")\ndf$Edu &lt;- factor(df$Edu, levels = c(0, 30, 39, 40, 41, 42, 43, 44, 45, 46), labels = c(\"Children\",\"High school Incomplete\", \"High School Complete\", \"College Incomplete\", \"Associate\", \"Associate\", \"Bachelor\", \"Master\", \"Professional Degree\", \"PHD\"))\n# We group categories 41 and 42 into \"Associate\"\n#table(df$Edu)\n\n### Race ###\n#table(df$Race)\ndf$Race &lt;- ifelse(df$Race &gt;= 6, 6, df$Race)\ndf$Race &lt;- factor(df$Race, levels = c(1, 2, 3, 4, 5, 6), labels = c(\"White\",\"Black\", \"American Indian\", \"Asian\", \"Pacific Islander\", \"Mixed\"))\n#table(df$Race)\n\n### Disabled ###\ndf$Pwd &lt;- factor(df$Pwd, levels = c(0, 1, 2), labels = c(\"NIU\", \"Yes\", \"No\"))\n#table(df$Pwd)\n\n### Health Status ###\ndf$Health &lt;- factor(df$Health, levels = c(1, 2, 3, 4, 5), labels = c(\"Excellent\", \"Very good\", \"Good\", \"Fair\", \"Poor\"))\n#table(df$Health)\n\n### Insurance Coverage ###\ndf$Ins &lt;- factor(df$Ins, levels = c(1, 2), labels = c(\"Yes\", \"No\"))\n\n\nFor instance, we have grouped the categories 1 (Employed - at work) and 2 (Employed - absent) into “Employed” on the feature that indicates the employment status.\nTo see the column types:\n\n\nCode\ndata.frame(sapply(df,class))\n\n\n       sapply.df..class.\nID               numeric\nWt               numeric\nState            integer\nCo               integer\nHealth            factor\nAge              integer\nSex               factor\nCitz              factor\nRace              factor\nEmpt              factor\nEdu               factor\nEarn             integer\nPwd               factor\nIns               factor\n\n\nFinally, we update the theme of ggplot to center the titles by default:\n\n\nCode\ntheme_update(plot.title = element_text(hjust = 0.5))"
  },
  {
    "objectID": "data.html#missing-value-analysis",
    "href": "data.html#missing-value-analysis",
    "title": "2  Data",
    "section": "2.4 Missing value analysis",
    "text": "2.4 Missing value analysis\nFortunately, there are no missing values for the subset of dimensions of the CPS-ASEC that we will work with.\nIndeed, we can look at this through the following graph:\n\n\nCode\nredav::plot_missing(df, percent=TRUE)\n\n\nScale for y is already present.\nAdding another scale for y, which will replace the existing scale.\nScale for y is already present.\nAdding another scale for y, which will replace the existing scale.\n\n\n\n\n\nWe have used the ‘plot_missing’ function from the ‘redav’ Package. We can see that there are no missing values on any dimension. Indeed, the only row pattern that exists in the dataset is the one that corresponds to ‘no missing values’, which is named ‘complete cases’. It is worth noting that the Census Bureau preprocesses the data and imputes missing values, before releasing the dataset. (More information about CPS ASEC preprocessing)\nAlternatively, we can draw the following graph:\n\n\nCode\nplot_missing_2 &lt;-\nfunction (data, group = list(Good = 0.05, Okay = 0.4, Poor = 0.8, \n  Scarce =  1), geom_label_args = list(), title = NULL, ggtheme = theme_gray(), \ntheme_config = list(legend.position = c(\"bottom\"))) \n{\n  pct_missing &lt;- Band &lt;- NULL\n  missing_value &lt;- data.table(profile_missing(data))\n  group &lt;- group[sort.list(unlist(group))]\n  invisible(lapply(seq_along(group), function(i) {\n    if (i == 1) {\n      missing_value[pct_missing &lt;= group[[i]], `:=`(Band,\n         names(group)[i])]\n    } else {\n  missing_value[pct_missing &gt; group[[i - 1]] & pct_missing &lt;= \n     group[[i]], `:=`(Band, names(group)[i])]\n    }\n}))\n  output &lt;- ggplot(missing_value, aes_string(x = \"feature\", \n    y = \"num_missing\", fill = \"Band\")) + geom_bar(stat = \"identity\") + \n   scale_fill_manual(\"Band\", values = c(\"Good\"=\"green2\",\"Okay\"=\"gold\",\"Poor\"=\"darkorange\",\"Scarce\"=\"firebrick2\")) + coord_flip() + xlab(\"Features\") + \n   ylab(\"Missing Rows\")\n  geom_label_args_list &lt;- list(mapping = aes(label = paste0(round(100 * \n    pct_missing, 2), \"%\")))\n  output &lt;- output + do.call(\"geom_label\", c(geom_label_args_list, \n     geom_label_args)) + scale_y_continuous(limits = c(0, 100), breaks = seq(0, 100, by = 10))\n  class(output) &lt;- c(\"single\", class(output))\n  plotDataExplorer(plot_obj = output, title = title, ggtheme = ggtheme, \n   theme_config = theme_config)\n}\n\n\nplot_missing_2(df)\n\n\nWarning: `aes_string()` was deprecated in ggplot2 3.0.0.\nℹ Please use tidy evaluation idioms with `aes()`.\nℹ See also `vignette(\"ggplot2-in-packages\")` for more information.\n\n\n\n\n\nTo create this graph we have used this adaptation from the ‘plot_missing’ function from the ‘DataExplorer’ package. Also, we have added a line of code inside the function to force the y-axis to start at 0. The graph indicates the share of rows with missing values for each of the 14 variables. It follows from the graph that there are no missing values in any of the dimensions. .\nThis characteristic of the dataset could also have been discovered through the following code:\n\n\nCode\ncolSums(is.na(df)) %&gt;% \n  sort (decreasing = TRUE)\n\n\n    ID     Wt  State     Co Health    Age    Sex   Citz   Race   Empt    Edu \n     0      0      0      0      0      0      0      0      0      0      0 \n  Earn    Pwd    Ins \n     0      0      0 \n\n\nAlthough there are no missing values, there are some questions that -by construction- are not asked to certain groups of people. In fact, as it can be checked on the official Data Dictionary, the dimensions ‘PEARNVAL’ and ‘DIS_HP’ are only available for people aged at least 15. It makes sense because ‘PEARNVAL’ refers to the earnings derived from wage or salary, or for self-employment income and ‘DIS_HP’ indicates whether or not the respondent has a disability that prevents them from working. Indeed, it can be checked that, for instance, the number of people with ‘DIS_HP’ == “NIU” that stands for “Not in Universe” equals the number of respondents up to 14 years old.\n\n\nCode\nnrow(df[df$Age &lt; 15, ]) == nrow(df[df$Pwd == \"NIU\", ])\n\n\n[1] TRUE"
  }
]